{"incoming.nft": "flush chain ip filter incoming\n# Rule: essential-icmpv6.sh\n# Rule: ping.sh\nadd rule ip filter incoming icmp type {echo-request} counter accept\nadd rule ip filter incoming icmp type {echo-reply} counter accept\n# Rule: ftp-helper.sh\ntable ip myhelpers {\n      ct helper ftp-standard {\n      \t type \"ftp\" protocol tcp\n      }\n}\nadd rule ip myhelpers prerouting tcp dport 21 ct helper set \"ftp-standard\"\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 22 counter accept\nadd rule ip filter incoming udp dport 22 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 80 counter accept\nadd rule ip filter incoming udp dport 80 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 443 counter accept\nadd rule ip filter incoming udp dport 443 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 21 counter accept\nadd rule ip filter incoming udp dport 21 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 143 counter accept\nadd rule ip filter incoming udp dport 143 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 993 counter accept\nadd rule ip filter incoming udp dport 993 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 110 counter accept\nadd rule ip filter incoming udp dport 110 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 995 counter accept\nadd rule ip filter incoming udp dport 995 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 25 counter accept\nadd rule ip filter incoming udp dport 25 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 465 counter accept\nadd rule ip filter incoming udp dport 465 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 587 counter accept\nadd rule ip filter incoming udp dport 587 counter accept\n# Rule: accept.sh\nadd rule ip filter incoming tcp dport 4190 counter accept\nadd rule ip filter incoming udp dport 4190 counter accept\n# Rule: reject.sh\nadd rule ip filter incoming counter jump rejectcounter\nflush chain ip6 filter incoming\n# Rule: essential-icmpv6.sh\nadd rule ip6 filter incoming icmpv6 type {destination-unreachable, packet-too-big, time-exceeded, parameter-problem} counter accept\nadd rule ip6 filter incoming icmpv6 type {nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert, nd-redirect} ip6 hoplimit 255 counter accept\n# Rule: ping.sh\nadd rule ip6 filter incoming icmpv6 type {echo-request} counter accept\nadd rule ip6 filter incoming icmpv6 type {echo-reply} counter accept\n# Rule: ftp-helper.sh\ntable ip6 myhelpers {\n      ct helper ftp-standard {\n      \t type \"ftp\" protocol tcp\n      }\n}\nadd rule ip6 myhelpers prerouting tcp dport 21 ct helper set \"ftp-standard\"\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 22 counter accept\nadd rule ip6 filter incoming udp dport 22 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 80 counter accept\nadd rule ip6 filter incoming udp dport 80 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 443 counter accept\nadd rule ip6 filter incoming udp dport 443 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 21 counter accept\nadd rule ip6 filter incoming udp dport 21 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 143 counter accept\nadd rule ip6 filter incoming udp dport 143 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 993 counter accept\nadd rule ip6 filter incoming udp dport 993 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 110 counter accept\nadd rule ip6 filter incoming udp dport 110 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 995 counter accept\nadd rule ip6 filter incoming udp dport 995 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 25 counter accept\nadd rule ip6 filter incoming udp dport 25 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 465 counter accept\nadd rule ip6 filter incoming udp dport 465 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 587 counter accept\nadd rule ip6 filter incoming udp dport 587 counter accept\n# Rule: accept.sh\nadd rule ip6 filter incoming tcp dport 4190 counter accept\nadd rule ip6 filter incoming udp dport 4190 counter accept\n# Rule: reject.sh\nadd rule ip6 filter incoming counter jump rejectcounter\n", "outgoing.nft": "flush chain ip filter outgoing\n# Rule: essential-icmpv6.sh\n# Rule: reject-www-data.sh\ntable ip filter {\n      chain reject-www-data {\n      \t    tcp dport 53 counter  accept\n      \t    udp dport 53 counter  accept\n      }    \n}\nadd rule ip filter reject-www-data counter jump rejectcounter\nadd rule ip filter outgoing meta skuid www-data counter jump reject-www-data\nflush chain ip6 filter outgoing\n# Rule: essential-icmpv6.sh\nadd rule ip6 filter outgoing icmpv6 type {destination-unreachable, packet-too-big, time-exceeded, parameter-problem} counter accept\nadd rule ip6 filter outgoing icmpv6 type {nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert, nd-redirect} ip6 hoplimit 255 counter accept\n# Rule: reject-www-data.sh\ntable ip6 filter {\n      chain reject-www-data {\n      \t    tcp dport 53 counter  accept\n      \t    udp dport 53 counter  accept\n      }    \n}\nadd rule ip6 filter reject-www-data counter jump rejectcounter\nadd rule ip6 filter outgoing meta skuid www-data counter jump reject-www-data\n", "whitelist_sets_init.nft": "add set ip filter w_all {type ipv4_addr; flags interval; auto-merge;}\n\n", "whitelist_sets_update.nft": "flush set ip filter w_all\n\n", "whitelist_sets.nft": "# Set for ports all\nadd element ip filter w_all {198.51.100.254}\n\n", "whitelist_sets_reload.nft": "include \"whitelist_sets_update.nft\"\ninclude \"whitelist_sets.nft\"\n", "whitelist.nft": "flush chain ip filter whitelist\nadd rule ip filter whitelist ip saddr @w_all counter accept\nflush chain ip6 filter whitelist\n", "blacklist_sets_init.nft": "add set ip filter b_all {type ipv4_addr; flags interval; auto-merge;}\nadd set ip filter b_22 {type ipv4_addr; flags interval; auto-merge;}\nadd set ip6 filter b_80_443 {type ipv6_addr; flags interval; auto-merge;}\n", "blacklist_sets_update.nft": "flush set ip filter b_all\nflush set ip filter b_22\nflush set ip6 filter b_80_443\n", "blacklist_sets.nft": "# Set for ports all\nadd element ip filter b_all {198.51.100.5,192.0.2.5,203.0.113.7}\n# Set for ports 22\nadd element ip filter b_22 {198.51.100.128}\n# Set for ports 80,443\nadd element ip6 filter b_80_443 {2001:db8:fab::/64}\n", "blacklist_sets_reload.nft": "include \"blacklist_sets_update.nft\"\ninclude \"blacklist_sets.nft\"\n", "blacklist.nft": "flush chain ip filter blacklist\nadd rule ip filter blacklist ip saddr @b_all counter log prefix \"Blacklist \" jump rejectcounter\nadd rule ip filter blacklist tcp dport 22 ip saddr @b_22 counter log prefix \"Blacklist \" jump rejectcounter\nadd rule ip filter blacklist udp dport 22 ip saddr @b_22 counter log prefix \"Blacklist \" jump rejectcounter\nflush chain ip6 filter blacklist\nadd rule ip6 filter blacklist tcp dport {80,443} ip6 saddr @b_80_443 counter log prefix \"Blacklist \" jump rejectcounter\nadd rule ip6 filter blacklist udp dport {80,443} ip6 saddr @b_80_443 counter log prefix \"Blacklist \" jump rejectcounter\n"}