.\" Automatically generated by Pandoc 2.2.1
.\"
.TH "NFTFWLS" "1" "" "" "Nftfw documentation"
.hy
.SH NAME
.PP
\f[B]nftfwls\f[] \- list \f[B]nftfw\f[] blacklist database
.SH SYNOPSIS
.PP
\f[B]nftfwls\f[] [\f[B]\-h\f[]] [\f[B]\-c\f[] \f[I]config\f[]]
[\f[B]\-p\f[] yes|no ] [\f[B]\-a |\-r | \-m | \-i | \-n | \-w | \-q |
\-v \f[]]
.SH DESCRIPTION
.PP
\f[B]nftfwls\f[] displays the status of the database storing the state
of the \f[B]nftfw\f[] firewall.
The default output only displays the IP addresses found in
\f[I]/etc/nftfw/blacklist.d\f[].
The \f[B]\-a\f[] option shows all entries in the database, and ignores
the contents of the \f[I]blacklist.d\f[] directory.
HTML output is also possible.
.PP
\f[B]nftfwls\f[] `pretty prints' a table with these headings:
.IP \[bu] 2
IPs: The blocked IP address
.IP \[bu] 2
Port: The port list used in the firewall for the IP
.IP \[bu] 2
Ct/Incd: The number of matches in log files triggered by this IP; a /
and the number of reported distinct incidents
.IP \[bu] 2
Latest: The date and time of the latest incident.
The \f[I]date_fmt\f[] key in \f[I]config.ini\f[] can alter date formats
from the default.
.IP \[bu] 2
First: The date and time of the first incident (or a minus sign `\-' if
it's the same as Latest)
.IP \[bu] 2
Duration: The time difference between the two times
.IP \[bu] 2
Pattern: The pattern or patterns that reported the incident or incidents
.PP
If the \f[I]geoip2\f[] country database is available, the IP address is
preceded by the ISO two letter country code of te site where the IP is
located.
.SS Text output
.PP
Text output uses the Python `prettytable' module.
When piping the output into another program, it's helpful to remove the
column separators, adding \f[B]\-n\f[] option make this happen.
.SS HTML output
.PP
The \f[B]\-w\f[] option selects HTML output.
It prints an HTML table suitable for inclusion on a web page.
Classes in the table allow styling.
.IP \[bu] 2
Class: `nftfwls' \- for <table>
.IP \[bu] 2
Class: `heading' for the heading <tr>
.IP \[bu] 2
Class; `content' for the remaining <tr> lines
.IP \[bu] 2
Class: `col1', `col2', up to `col7' for the appropriate <td> cells.
.PP
If the \f[I]geoip2\f[] country database is available, the IP address is
preceded by the ISO two letter country code of te site where the IP is
located.
Mouse over the code to get the full country name.
.SS Options
.TP
.B \f[B]\-h\f[], \f[B]\-\-help\f[]
Prints brief usage information.
.RS
.RE
.TP
.B \f[B]\-w\f[], \f[B]\-\-web\f[]
Print output as an HTML table, enabling integration into a web page.
.RS
.RE
.TP
.B \f[B]\-a \f[], \f[B]\-\-all\f[]
Prints all the informarion in the database, ignoring entries in
\f[I]blacklist.d\f[]
.RS
.RE
.TP
.B \f[B]\-p \f[], \f[B]\-\-pattern_split\f[] yes|no
If `yes', splits the pattern column at any comma, making separate lines
for entries with more than one stored pattern; if `no' prints a single
line for the pattern column.
The \f[I]pattern_split\f[] value in the config.ini file sets the usual
default value.
.RS
.RE
.TP
.B \f[B]\-r\f[], \f[B]\-\-reverse\f[]
Reverse sorting order
.RS
.RE
.TP
.B \f[B]\-m\f[], \f[B]\-\-matchcount\f[]
Sort by match count
.RS
.RE
.TP
.B \f[B]\-i\f[], \f[B]\-\-incidents\f[]
Sort by incidents
.RS
.RE
.TP
.B \f[B]\-n\f[], \f[B]\-\-noborder\f[]
Don't print a border to the table.
.RS
.RE
.TP
.B \f[B]\-c \f[], \f[B]\-\-config\f[] CONFIG
Supply a configuration file, overriding any values from the default
system settings.
.RS
.RE
.TP
.B \f[B]\-q\f[], \f[B]\-\-quiet\f[]
Suppress printing of errors and information messages to the terminal,
syslog output remains active.
Terminal output is suppressed when the output is not directed to a
terminal
.RS
.RE
.TP
.B \f[B]\-v\f[], \f[B]\-\-verbose\f[]
Change the default logging settings to INFO to show all errors and
information messages.
.RS
.RE
.SH FILES
.PP
Files can be located in \f[I]/\f[] or \f[I]/usr/local\f[].
.TP
.B \f[I]/etc/nftfw\f[]
Location of control files
.RS
.RE
.TP
.B \f[I]/var/lib/nftfw/\f[]
Location of \f[I]build\f[], \f[I]install\f[], lock file and sqlite3
databases storing file positions and blacklist information
.RS
.RE
.SH BUGS
.PP
See GitHub Issues: <https://github.com/pcollinson/nftfw/issues>
.SH AUTHOR
.PP
Peter Collinson (huge credit to the ideas from Patrick Cherry's work for
the firewall for the Symbiosis hosting system).
.SH SEE ALSO
.PP
\f[B]nft(1)\f[], \f[B]nftfw(1)\f[], \f[B]nftfwedit(1)\f[],
\f[B]nftfwadm(1)\f[], \f[B]nftfw\-config(5)\f[],
\f[B]nftfw\-files(5)\f[]
